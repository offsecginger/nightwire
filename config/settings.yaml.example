# nightwire configuration
# Copy to settings.yaml and customize

# Phone numbers or Signal UUIDs authorized to use the bot
# Supports E.164 phone numbers and Signal UUIDs (for modern accounts)
# IMPORTANT: Replace with your actual phone number or UUID
allowed_numbers:
  - "+1XXXXXXXXXX"
  # - "a1b2c3d4-e5f6-7890-abcd-ef1234567890"  # Signal UUID example

# Signal CLI REST API connection
signal_api_url: "http://127.0.0.1:8080"

# Claude CLI settings
claude_timeout: 600           # Max seconds per Claude invocation
claude_max_turns: 15          # Max conversation turns per invocation
# claude_path: "/usr/local/bin/claude"  # Override Claude CLI path

# Memory System
memory:
  session_timeout: 30          # Minutes before session expires
  max_context_tokens: 1500     # Max tokens for memory context injection

# Autonomous Task System
autonomous:
  enabled: true
  poll_interval: 30            # Seconds between task queue polls
  quality_gates: true          # Run tests/typecheck after each task
  max_parallel: 3              # Max concurrent task workers (1-10)
  verification: true           # Independent code review of task output
  # effort_levels:             # Override effort per task type
  #   implementation: "high"
  #   bug_fix: "high"
  #   refactor: "medium"
  #   testing: "medium"
  #   prd_breakdown: "max"
  #   verification: "low"

# Rate Limiting
# Currently hardcoded to 30 requests per 60-second window per user.
# Configurable rate limiting is planned for a future release.

# Rate Limit Cooldown — pauses all Claude operations when subscription cap is hit
# rate_limit_cooldown:
#   enabled: true
#   cooldown_minutes: 60             # How long to pause (default: 60 min)
#   consecutive_threshold: 3         # Transient rate-limit failures before cooldown
#   failure_window_seconds: 300      # Window for counting consecutive failures

# Optional: nightwire AI assistant (any OpenAI-compatible provider)
nightwire_assistant:
  enabled: false
  # Built-in providers: "openai", "grok" (auto-detected from API keys if omitted)
  # Or use any OpenAI-compatible provider with api_url + api_key_env + model
  # provider: "openai"
  # model: "gpt-4o"
  # max_tokens: 1024
  #
  # Custom provider example (any OpenAI-compatible API):
  # api_url: "https://api.example.com/v1/chat/completions"
  # api_key_env: "MY_PROVIDER_API_KEY"   # env var name holding your API key
  # model: "model-name"

# Legacy nova / grok config sections are still recognized for backward compatibility

# Project directories
# projects_base_path: "/home/user/projects"
# allowed_paths:
#   - "/home/user/projects"

# Plugins — extend nightwire with custom functionality
# Each plugin has its own config section under plugins.<name>
# plugins:
#   daily_verse:
#     enabled: true
#     hour: 8
#     minute: 30
#     recipients: ["+1XXXXXXXXXX"]   # defaults to allowed_numbers
#   bluos_music:
#     enabled: true
#     players:
#       main_floor: { name: "Main Floor", ip: "10.0.0.1" }
#     groups:
#       inside: [main_floor]

# Plugin allowlist — if set, only these plugins will be loaded.
# Omit or leave empty to load all plugins.
# plugin_allowlist:
#   - daily_verse
#   - bluos_music

# Auto-Update (optional, default off)
# Periodically checks for new commits and notifies admin via Signal
# auto_update:
#   enabled: false
#   check_interval: 21600      # Seconds between checks (default: 6 hours)
#   branch: "main"             # Git branch to track

# Docker Sandbox (optional, default off)
# Runs Claude task execution inside a Docker container for isolation
# sandbox:
#   enabled: false
#   image: "python:3.11-slim"
#   network: false           # Deny network access in sandbox
#   memory_limit: "2g"
#   cpu_limit: 2.0
